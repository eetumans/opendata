---

- name: Configure ufw rules
  ufw:
    rule: "{{ item.rule|default('allow') }}"
    proto: "{{ item.proto|default(omit) }}"
    src: "{{ item.src|default(omit) }}"
    to_port: "{{ item.to_port|default(omit) }}"
    comment: "{{ item.comment |default(omit) }}"
    delete: " {{item.delete |default('no') }}"
  with_items:
    - "{{ firewall_rules }}"

- name: Enable ufw
  ufw:
    state: enabled
  tags:
    - ufw
